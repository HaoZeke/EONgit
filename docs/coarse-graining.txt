================
Coarse-Graining
================

In aKMC simulations where there are vastly different rates, the simulation can get stuck in a group of states connected by relatively fast rates. In order to explore slower transitions, a prohibitively large number of KMC steps may be needed. In order to circumvent this problem, eOn implements two methods. The first method, projective dynamics [#novotny]_, groups states that are joined by fast rates into "superbasins". Information about transitions between states in a superbasin is lost, but the rates for transitions across a superbasin are correct. The second method, accelerated superbasing kinetic Monte Carlo (AS-KMC) [#voter]_, artificially raises low barriers. The dynamics between states connected by fast rates are simulated, but an error is introduced in the dynamics direction and time. Both methods cannot be used simultaneously.

Options for these methods go in the [Superbasins] section.

Projective Dynamics
--------------------
**use_superbasins** [False]
    This option determines whether the projective dynamics coarse-graining method will be used. This mutually excludes the **use_askmc** option.

**scheme** [transition_counting]
    Projective dynamics provides a method for calculating transition rates across superbasins. An additional method is needed in order to decide when to combine states into a superbasin. eOn provides two methods. The first method, called "transition counting", counts the number of times that the simulation has transitioned between a given pair of states. After a critical number of transitions have occured, the pair of states are merged to form a superbasin. (If one is already in a superbasin, the other is added to that superbasin. If both are already in superbasins, the two superbasins are merged). This method can be selected by setting scheme equal to 'transition_counting'. **Jean-Claude: document your scheme here** This method can be elected by setting scheme equal to 'energy_level'.

**number_of_transitions** [50]
    If the transition counting scheme is being used (scheme=transition_counting), this is the number of transitions that must occur between two states before they are merged into a superbasin.

**energy_increment** [0.1]
    If the energy level scheme is being used (scheme=energy_level), **Jean Claude: document this**


Accelerated Superbasin Kinetic Monte Carlo
--------------------------------------------
**use_askmc** [False]
    This option determines whether the AS-KMC coarse-graining method will be used. This mutually excludes the **use_superbasins** option.

**askmc_confidence** [0.9]
    The conﬁdence for AS-KMC. This value determines the accuracy of the direction of the dynamics trajectory. (:math:`1-\delta` in the reference.)

**askmc_barrier_raise_param** [1.5]
    This parameter sets how much the barriers are raised during AS-KMC. (:math:`\alpha` in the reference.)

**askmc_high_barrier_def** [2]
    This parameter sets how high a barrier must be to be considered “high” in AS-KMC. (:math:`\gamma` in the reference.)

**askmc_barrier_test_on** [True]
    This parameter determines whether to ensure no low barriers are missed. **What goes wrong if low barriers are missed?**
    
**askmc_connections_test_on** [False]
    This parameter determines whether to ensure no internal low-barrier connections are missed. **What goes wrong if internal low-barriers are missed? What is an internal low barrier?**



.. [#novotny] http://arxiv.org/abs/cond-mat/0109182
.. [#voter] http://jcp.aip.org/jcpsa6/v132/i19/p194101_s1
